# Authentication and Security Rules for CSI NMAMIT

# NextAuth configuration
pattern: src/server/auth.ts
policy: readonly
description: "NextAuth configuration should not be modified by AI"

# Authentication API routes
pattern: src/pages/api/auth/**/*.ts
policy: readonly
description: "Authentication API routes should not be modified by AI"

# Session management
pattern: **/*.tsx
enforce:
  useSessionHook: true
  useAuthProtection: true
  useRoleBasedAccess: true

# Protected routes
pattern: src/pages/**/*.tsx
enforce:
  useAuthGuard: true
  useRoleValidation: true
  usePermissionChecks: true

# API security
pattern: src/server/api/**/*.ts
enforce:
  useAuthMiddleware: true
  useInputValidation: true
  useRateLimiting: true
  useCORS: true

# Environment variables for auth
pattern: **/*.ts
forbid: ["process.env.NEXTAUTH_SECRET", "process.env.GOOGLE_CLIENT_SECRET"]
enforce:
  useEnvValidation: true

# User data protection
pattern: **/*.ts
enforce:
  useDataSanitization: true
  useInputValidation: true
  useOutputSanitization: true

# Payment security (Razorpay)
pattern: **/*.ts
forbid: ["process.env.RAZORPAY_KEY_SECRET"]
enforce:
  usePaymentValidation: true
  useTransactionLogging: true
description:
globs:
alwaysApply: false
---
